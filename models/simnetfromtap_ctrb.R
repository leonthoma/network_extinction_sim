# fy for simulating webs with user specified community var contributions
simnetfromtap_ctrb <- function(traits,
                               abuns,
                               paramsList,
                               pems,
                               tmatch_type_pem,
                               tmatch_type_obs,
                               ctrb_vec = c(NULL),
                               Nwebs,
                               Nobs) {
  # create networks
  sim <- simnetfromtap_aug(traits = traits,
                           abuns = abuns,
                           paramsList = paramsList,
                           pems = pems,
                           tmatch_type_pem = tmatch_type_pem,
                           tmatch_type_obs = tmatch_type_obs,
                           ctrb_vec = ctrb_vec)
  # get web from Imat
  simweb <- matrix(rmultinom(1, Nobs, sim), nrow = nrow(sim),
                   ncol = ncol(sim))
  # set sp names
  dimnames(simweb) <- dimnames(init_sim$networks[[1]]$I_mat)
  
  return(simweb)
}
